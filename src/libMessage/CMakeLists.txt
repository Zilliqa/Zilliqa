protobuf_generate_cpp(PROTO_SRC PROTO_HEADER ZilliqaMessage.proto)

add_library (MessageCommon STATIC ${PROTO_SRC} MessengerCommon.cpp)
target_include_directories (MessageCommon PUBLIC ${PROJECT_SOURCE_DIR}/src ${CMAKE_BINARY_DIR}/src)
target_link_libraries (MessageCommon PUBLIC protobuf::libprotobuf)

add_library (Message STATIC Messenger.cpp MessengerAccountStoreBase.cpp MessengerAccountStoreTrie.cpp)
get_target_property(MESSAGE_COMPILE_FLAGS Message COMPILE_OPTIONS )
message(STATUS "Message compile flags old = ${MESSAGE_COMPILE_FLAGS}")
list(REMOVE_ITEM MESSAGE_COMPILE_FLAGS -Wextra -Werror)
message(STATUS "Message compile flags new = ${MESSAGE_COMPILE_FLAGS}")
set_target_properties(Message PROPERTIES COMPILE_OPTIONS "${MESSAGE_COMPILE_FLAGS}")
target_include_directories (Message PUBLIC ${PROJECT_SOURCE_DIR}/src ${CMAKE_BINARY_DIR}/src)
target_link_libraries (Message PUBLIC MessageCommon AccountStore AccountData Blockchain MiningData CoinbaseData Network)

add_library (MessageSWInfo STATIC MessengerSWInfo.cpp)
get_target_property(MESSAGESWINFO_COMPILE_FLAGS MessageSWInfo COMPILE_OPTIONS )
message(STATUS "MessageSWInfo compile flags old = ${MESSAGESWINFO_COMPILE_FLAGS}")
list(REMOVE_ITEM MESSAGESWINFO_COMPILE_FLAGS -Wextra -Werror)
message(STATUS "MessageSWInfo compile flags new = ${MESSAGESWINFO_COMPILE_FLAGS}")
set_target_properties(MessageSWInfo PROPERTIES COMPILE_OPTIONS "${MESSAGESWINFO_COMPILE_FLAGS}")
target_include_directories (MessageSWInfo PUBLIC ${PROJECT_SOURCE_DIR}/src ${CMAKE_BINARY_DIR}/src)
target_link_libraries (MessageSWInfo PUBLIC MessageCommon)
